# GitHub Actions Goat: Vulnerable by Design GitHub Actions Workflows

[![Maintained by stepsecurity.io](https://img.shields.io/badge/maintained%20by-stepsecurity.io-blueviolet)](https://stepsecurity.io/?utm_source=github&utm_medium=organic_oss&utm_campaign=harden-runner)
[![License: Apache 2.0](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://raw.githubusercontent.com/step-security/harden-runner/main/LICENSE)

GitHub Actions Goat by [StepSecurity](stepsecurity.io) is an educational project that simulates common security mistakes that can occur in GitHub Actions workflows.

The importance of Continuous Integration/Continuous Deployment (CI/CD) security has recently been underlined by guidance from the Cybersecurity & Infrastructure Security Agency (CISA) and the National Security Agency (NSA). As per their document [Defending Continuous Integration/Continuous Delivery (CI/CD) Environments](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF), CI/CD environments have become attractive targets for malicious cyber actors (MCAs) aiming to introduce malicious code, steal intellectual property, or cause denial of service attacks against applications.

The increasing number of supply chain attacks on CI/CD environments, such as the infamous SolarWinds, Codecov, and ua-parser-js attacks, paints a vivid picture of this growing threat.

GitHub Actions Goat incorporates best practices from [GitHub's Security Hardening for GitHub Actions guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions) and the [CISA/ NSA guidance on CI/CD Security](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF) to showcase how these vulnerabilities can be avoided in real-world GitHub Actions workflows.

## Understanding Vulnerabilities and Solutions with GitHub Actions Goat

This project not only demonstrates vulnerabilities but also presents solutions and references to best practices for each issue. In each scenario, we demonstrate how a particular threat can be mitigated.

| No. | Vulnerability                                                                                           | Solution                                                                                                          | References                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| --- | ------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1.  | [Poisoned Workflows Exfiltrating CI/CD Secrets](docs/ExfiltratingCICDSecrets.md)                        | [GitHub Actions Runtime Security - Filter Network Traffic](docs/RestrictOutboundTraffic.md)                       | 1. [Implement network segmentation and traffic filtering](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)<br/>2. [Implement endpoint detection and response (EDR) tools](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                                                      |
| 2.  | [Poisoned Workflows Tampering with Source Code or Artifacts during Build](docs/TamperingDuringBuild.md) | [GitHub Actions Runtime Security - Detect File Tampering](docs/MonitorSourceCode.md)                              | [Implement endpoint detection and response (EDR) tools](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                                                                                                                                                                                                                      |
| 3.  | [Secrets Stored as Plaintext in Workflow Files](#)                                                      | [Scan for Secrets in Workflow Files](#)                                                                           | 1. ["Using Secrets" section in GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-secrets) <br/>2. ["Secure secrets" section in CISA/NSA document](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                                                      |
| 4.  | [Secrets Logged in the Build Logs](#)                                                                   | [Scan for Secrets in Build Logs](#)                                                                               | 1. ["Using Secrets" section in GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-secrets) <br/>2. ["Secure secrets" section in CISA/NSA document](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                                                      |
| 5.  | [Overprivileged GITHUB_TOKEN Permissions](#)                                                            | [Update workflows to use least privileged GITHUB_TOKEN permissions](#)                                            | ["Use credentials that are minimally scoped" in GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-secrets)                                                                                                                                                                                                                                                                                                                                                                                            |
| 6.  | [Use of Long-Term CI/CD Credentials](#)                                                                 | 1. [Audit and rotate registered secrets](#) <br/> 2. [Use OpenID Connect (OIDC) in GitHub Actions workflows](#)   | 1. ["Audit and rotate secrets" in GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-secrets) <br/>2. ["Using OpenID Connect to access cloud resources" in GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-openid-connect-to-access-cloud-resources) <br/>3. ["Minimize the use of long-term credentials" in CISA/NSA document](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF) |
| 7.  | [Use of Untrusted 3rd Party GitHub Actions](#)                                                          | 1. [Review GitHub Actions used across your Organization](#) <br/> 2. [Pin actions to a full length commit SHA](#) | 1. ["Using 3rd party Actions" in GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-third-party-actions) <br/>2. ["Restrict untrusted libraries and tools" section in CISA/NSA document](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                |
| 8.  | [Outdated GitHub Actions with Known Vulnerabilities](#)                                                 | [Configure Dependabot to keep Actions up to date](#)                                                              | 1. [Using Dependabot version updates to keep Actions up to date from GitHub's Security Guide](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-dependabot-version-updates-to-keep-actions-up-to-date) <br/>2. [Keep CI/CD tools up-to-date section in CISA/NSA document](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                       |
| 9.  | [Lack of Detailed Audit Logs for CI/CD Activities](#)                                                   | [Trace deployments to CI/CD pipeline and commit](#)                                                               | ["Keep audit logs" section in CISA/NSA guide](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                                                                                                                                                                                                                                |
| 10. | [Absence of Security Scanning within the CI/CD Pipeline](#)                                             | [Integrate security scanning as part of the CI/CD pipeline](#)                                                    | ["Integrate security scanning as part of the CI/CD pipeline" section of the CISA/NSA guide](https://media.defense.gov/2023/Jun/28/2003249466/-1/-1/0/CSI_DEFENDING_CI_CD_ENVIRONMENTS.PDF)                                                                                                                                                                                                                                                                                                                                                                                  |
